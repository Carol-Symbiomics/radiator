<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>sexy_markers finds sex-linked markers and re-assigns sex — sexy_markers • radiator</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="sexy_markers finds sex-linked markers and re-assigns sex — sexy_markers" />

<meta property="og:description" content="This function identifies sex-linked markers putatively located on
homogametic or heterogametic chromosomes and re-assign the sex in a dataset
based on findings. The function work best in: DArT silico (counts) &amp;gt;
DArT counts or RADseq with allele read depth &amp;gt; DArT silico (genotypes) &amp;gt;
RADseq (genotypes) and DArT (1-row, 2-rows genotypes)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">radiator</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/getting_started.html">Getting started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="http://thierrygosselin.github.io/assigner/articles/rad_genomics_computer_setup.html">Troubleshooting</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thierrygosselin/radiator">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>sexy_markers finds sex-linked markers and re-assigns sex</h1>
    <small class="dont-index">Source: <a href='https://github.com/thierrygosselin/radiator/blob/master/R/sex_markers.R'><code>R/sex_markers.R</code></a></small>
    <div class="hidden name"><code>sexy_markers.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function identifies sex-linked markers putatively located on
homogametic or heterogametic chromosomes and re-assign the sex in a dataset
based on findings. The function work best in: DArT silico (counts) &gt;
DArT counts or RADseq with allele read depth &gt; DArT silico (genotypes) &gt;
RADseq (genotypes) and DArT (1-row, 2-rows genotypes).</p>
    
    </div>

    <pre class="usage"><span class='fu'>sexy_markers</span>(<span class='no'>data</span>, <span class='kw'>silicodata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>boost.analysis</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>coverage.thresholds</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>filters</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>interactive.filter</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>parallel.core</span> <span class='kw'>=</span> <span class='kw pkg'>parallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/parallel/topics/detectCores'>detectCores</a></span>() -
  <span class='fl'>1</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>(object or file) DArT file <code>.csv or .tsv</code>, VCF file <code>.vcf</code>,
GDS file or object (<code>.gds</code>).
See Input data section data for more details.</p></td>
    </tr>
    <tr>
      <th>silicodata</th>
      <td><p>(optional, file) A silico DArT file (.csv or .tsv). This can be
count or genotyped data. Note that both <code>data</code> and <code>silicodata</code> can
be used at the same time.
Default: <code>silicodata = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>boost.analysis</th>
      <td><p>(logical, optional) This method uses machine learning
approaches to find sex markers and re-assign samples in sex group.
The approach is currently been tested and will be available for uses soon.#'
Default: <code>boost.analysis = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>(file) A tab delimited file with a minimum of
2 columns <code>INDIVIDUALS, STRATA</code> for VCF files and 3 columns for DArT files
<code>TARGET_ID, INDIVIDUALS, STRATA</code>.</p><ul>
<li><p><code>TARGET_ID:</code> it's the column header of the DArT file.</p></li>
<li><p><code>STRATA:</code> is the grouping column, here the sex info.
3 values: <code>M</code> for male, <code>F</code> for female and <code>U</code> for unknown.
Anything else is converted to <code>U</code>.</p></li>
<li><p><code>INDIVIDUALS:</code> Is how you want your samples to be named.</p></li>
</ul><p>Default: <code>strata = NULL</code>, the function will look for sex info in the
tidy data or GDS data (individuals.meta section).
You can easily build the strata file by starting with the output of these
functions: <code><a href='extract_dart_target_id.html'>extract_dart_target_id</a></code> and <code><a href='extract_individuals_vcf.html'>extract_individuals_vcf</a></code></p></td>
    </tr>
    <tr>
      <th>coverage.thresholds</th>
      <td><p>(optional, integer) The minimum coverage required
to account for the genotype.
Default: <code>coverage.thresholds = 1</code>.</p></td>
    </tr>
    <tr>
      <th>filters</th>
      <td><p>(optional, logical) When <code>filters = TRUE</code>, the data will
be filtered for
monomorphic loci, missingness of individuals and heterozygosity of individuals.
CAUTION: we advice to use these filter, since not filtering or filtering too
stingently will results in
false positve or false negative detections.
Default: <code>filters = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>interactive.filter</th>
      <td><p>(optional, logical)
Default: <code>interactive.filter = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>parallel.core</th>
      <td><p>(optional) The number of core used for parallel
execution during import.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(optional) Advance mode that allows to pass further arguments
for fine-tuning the function. Also used for legacy arguments (see details or
special section)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with ...</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes DArT and RAD data to find markers that have a specific
 pattern that is linked to sex.
The function hypothesizes the presence of sex-chromosomes in you
species/population. The tests are designed to identify markers that are
located on putative heterogametic (Y or W) or homogametic (X or Z) chromosomes.
<em>Note:</em> Violating Assumptions or Prerequisites (see below) can lead to
false positive or the absence of detection of sex-linked markers.</p>
    
    <h2 class="hasAnchor" id="assumptions"><a class="anchor" href="#assumptions"></a>Assumptions</h2>

    
    <ol>
<li><p><strong>Genetic Sex Determination System</strong> over a e.g. environmental-sex-determination system.</p></li>
<li><p><strong>Genome coverage:</strong> restriction sites randomly spread throughout the whole genome.</p></li>
<li><p><strong>Mutations:</strong> Processes such as sex-specific mutations
in the restriction sites could lead to false positive results.</p></li>
<li><p><strong>Deletions/duplications:</strong> Processes such as
sex-specific deletions or duplications could lead to false positive results.</p></li>
<li><p><strong>Homology:</strong> The existence of homologous sequences between the
homogametic and heterogametic chromosomes could lead to false negative
results.</p></li>
<li><p><strong>Absence of population signal</strong></p></li>
</ol>
    
    <h2 class="hasAnchor" id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>

    
    <ol>
<li><p><strong>Sample size:</strong> Ideally, the data must have enough individuals (n &gt; 100).</p></li>
<li><p><strong>Batch effect:</strong> Sex should be randomized on lanes/chips during sequencing.</p></li>
<li><p><strong>Sex ratio:</strong> Dataset with equal ratio work best.</p></li>
<li><p><strong>Genotyping rate</strong>: for DArT data, if the minimum call rate is
&gt; 0.5 ask DArT to lower their filtering threshold.
RADseq data, lower markers missingness thresholds during filtering
(e.g. stacks <code>r</code> and <code>p</code>).</p></li>
<li><p><strong>Identity-by-Missingness:</strong> Absence of artifactual pattern
of missingness (<a href='https://github.com/thierrygosselin/grur'>see missing visualization</a>)</p></li>
<li><p><strong>Low genotyping error rate:</strong> see <code><a href='detect_het_outliers.html'>detect_het_outliers</a></code>
and <a href='https://github.com/eriqande/whoa'>whoa</a>.</p></li>
<li><p><strong>Low heterozygosity miscall rate:</strong> see <code><a href='detect_het_outliers.html'>detect_het_outliers</a></code> and
<a href='https://github.com/eriqande/whoa'>whoa</a>.</p></li>
<li><p><strong>Absence of pattern of heterozygosity driven by missingness:</strong>
see <code><a href='detect_mixed_genomes.html'>detect_mixed_genomes</a></code>.</p></li>
<li><p><strong>Absence of paralogous sequences in the data</strong>.</p></li>
</ol>
    
    <h2 class="hasAnchor" id="sex-methods"><a class="anchor" href="#sex-methods"></a>Sex methods</h2>

    
    <p><strong>Heterogametic sex-markers:</strong></p><ul>
<li><p><strong>Presence/Absence method</strong>: To identify markers on Y or W chromosomes,
we look at the presence or
absence of a marker between females and males. More specifically, if a marker
is always present in males but never in females, they are putatively located
in the Y-chromosome; and vice versa for the W-linked markers.</p></li>
</ul><p><strong>Homogametic sex-markers:</strong>
We have two different methods to identify markers on X or Z chromosomes:</p><ul>
<li><p><strong>Heterozygosity method:</strong> By looking at the heterozygosity of a marker between sexes, we can
identify markers that are always homozygous in one sex (e.g. males for an
XY system), while exhibiting an intermediate range of heterozygosity in the
other sex (0.1 - 0.5).</p></li>
<li><p><strong>Coverage method:</strong> If the data includes count information, this function will look for
markers that have double the number of counts for either of the sexes.
For example if an XY/XX system is present, females are expected to have
double the number of counts for markers on the X chromosome.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="life-cycle"><a class="anchor" href="#life-cycle"></a>Life cycle</h2>

    
    <p>Machine Learning approaches (Random Forest and Extreme Gradient Boosting Trees)
are currently been tested. They usually show a lower discovery rate but tend to
perform better with new samples.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Eric Anderson's <a href='https://github.com/eriqande/whoa'>whoa</a> package.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># The minumum</span>
<span class='no'>sex.markers</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>radiator</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/radiator/topics/sexy_markers'>sexy_markers</a></span>(
    <span class='kw'>data</span> <span class='kw'>=</span> <span class='st'>"shark.dart.data.csv"</span>,
    <span class='kw'>strata</span> <span class='kw'>=</span> <span class='st'>"shark.strata.tsv"</span>)
<span class='co'># This will use the default: interactive version and a list is created and to view the sex markers</span>
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#assumptions">Assumptions</a></li>

      <li><a href="#prerequisites">Prerequisites</a></li>

      <li><a href="#sex-methods">Sex methods</a></li>

      <li><a href="#life-cycle">Life cycle</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Floriaan Devloo-Delva <a href='mailto:Floriaan.Devloo-Delva@csiro.au'>Floriaan.Devloo-Delva@csiro.au</a> and with help from
Thierry Gosselin <a href='mailto:thierrygosselin@icloud.com'>thierrygosselin@icloud.com</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thierry Gosselin, Floriaan Devloo-Delva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

